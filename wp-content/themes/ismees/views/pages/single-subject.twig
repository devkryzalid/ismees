{% extends 'base.twig' %}
{% block content %}
<main class="single-subject" data-aos="fade" data-aos-delay="300">
    {% include "partials/banners/banner-image-title.twig" with {
            'post': subject,
            'anchor': "#resources"
        }
    %}

    {% include "partials/page-content/content-reviews-socials.twig" with {
            'page': subject,
            'backBtnLink': options.config_subjects,
            'backBtnText': __('Retour aux sujets', 'ismees')
        } 
    %}
    
    {% include "partials/more-resources.twig" with {
        'items': subject.meta('resources'),
        'taxonomy': 'resource_category',
        'redirectionUrl': options.config_students_resources
    } %}
</main>
{% endblock %}

{# META FOR ADDSEARCH CUSTOM FIELDS #}
{% block addsearch_meta %}
    {% set meta_tags = {
        'page': 'research',
        'title': subject.title,
        'subject_ids': subject.id,
        'image': subject.thumbnail,
        'resource': 'student',
    } %}

    {% for tag, value in meta_tags %}
        {% if value %}
            {% if value is iterable %}
                {% set meta_content = [] %}
                {% for item in value %}
                    {% set meta_content = meta_content|merge([tag ~ "=" ~ item]) %}
                {% endfor %}
                <meta name="addsearch-custom-field" data-type="text" content="{{ meta_content|join(';') }}">
            {% else %}
                <meta name="addsearch-custom-field" data-type="text" content="{{ tag }}={{ value }}">
            {% endif %}
        {% endif %}
    {% endfor %}
{% endblock %}